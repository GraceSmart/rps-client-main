{"remainingRequest":"/Users/gracesmart/Desktop/rps-client-main/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gracesmart/Desktop/rps-client-main/src/components/Gesture.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gracesmart/Desktop/rps-client-main/src/components/Gesture.vue","mtime":1624886053000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIHRmIGZyb20gIkB0ZW5zb3JmbG93L3RmanMiOwppbXBvcnQgKiBhcyB0bUltYWdlIGZyb20gIkB0ZWFjaGFibGVtYWNoaW5lL2ltYWdlIjsKZXhwb3J0IGRlZmF1bHQgewogIG5hbWU6ICJBcHAiLAogIGNvbXBvbmVudHM6IHt9LAogIGRhdGEoKSB7CiAgICByZXR1cm4gewogICAgICB2aWRlb0RldmljZTogIiIsCiAgICAgIGRldmljZXM6IFtdLAogICAgICBiYXNlTW9kZWw6ICJtb2JpbGVuZXRfdjIiLAogICAgICBpc01vZGVsUmVhZHk6IGZhbHNlLAogICAgICBwcmVkaWN0aW9uczogWwogICAgICAgIHsgbmFtZTogJ1JvY2snLCBzY29yZTogMCB9LAogICAgICAgIHsgbmFtZTogJ1BhcGVyJywgc2NvcmU6IDAgfSwKICAgICAgICB7IG5hbWU6ICdTY2lzc29ycycsIHNjb3JlOiAwIH0KICAgICAgXSwKICAgICAgbGFzdFByZWRpY3Rpb246ICIiLAogICAgfTsKICB9LAogIG1vdW50ZWQoKSB7CiAgICB0Zi5zZXRCYWNrZW5kKCJ3ZWJnbCIpOwogICAgdGhpcy5saXN0VmlkZW9EZXZpY2VzKCkKICAgICAgLnRoZW4oKHZpZGVvRGV2aWNlcykgPT4gewogICAgICAgIGZvciAobGV0IGRldmljZSBvZiB2aWRlb0RldmljZXMpIHsKICAgICAgICAgIHRoaXMuZGV2aWNlcy5wdXNoKGRldmljZSk7CiAgICAgICAgfQogICAgICAgIHRoaXMudmlkZW9EZXZpY2UgPSB2aWRlb0RldmljZXNbMF0uZGV2aWNlSWQ7CiAgICAgIH0pCiAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICByZXR1cm4gdGhpcy5pbml0V2ViY2FtU3RyZWFtKCk7CiAgICAgIH0pCiAgICAgIC50aGVuKCgpID0+IHsKICAgICAgICByZXR1cm4gdGhpcy5sb2FkTW9kZWwoKS50aGVuKCgpID0+IHsKICAgICAgICAgIHRoaXMuZGV0ZWN0T2JqZWN0cygpOwogICAgICAgIH0pOwogICAgICB9KTsKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICBpZiAodGhpcy5yYWYpIHsKICAgICAgbGV0IHZpZGVvID0gdGhpcy4kcmVmcy52aWRlbwogICAgICB2aWRlby5wYXVzZSgpCiAgICAgIHZpZGVvLnNyY09iamVjdCA9IG51bGwKICAgICAgCiAgICAgIHRoaXMuc3RyZWFtLmdldFRyYWNrcygpLmZvckVhY2godHJhY2sgPT4gewogICAgICAgIHRyYWNrLnN0b3AoKQogICAgICB9KQogICAgICB0aGlzLmlzVmlkZW9TdHJlYW1SZWFkeSA9IGZhbHNlCiAgICAgIGNhbmNlbEFuaW1hdGlvbkZyYW1lKHRoaXMucmFmKQogICAgfQogIH0sCiAgbWV0aG9kczogewogICAgbGlzdFZpZGVvRGV2aWNlcygpIHsKICAgICAgcmV0dXJuIG5hdmlnYXRvci5tZWRpYURldmljZXMuZW51bWVyYXRlRGV2aWNlcygpLnRoZW4oKGRldmljZXMpID0+IHsKICAgICAgICByZXR1cm4gZGV2aWNlcy5maWx0ZXIoKGRldmljZSkgPT4gZGV2aWNlLmtpbmQgPT09ICJ2aWRlb2lucHV0Iik7CiAgICAgIH0pOwogICAgfSwKICAgIGluaXRXZWJjYW1TdHJlYW0oKSB7CiAgICAgIHRoaXMuaXNWaWRlb1N0cmVhbVJlYWR5ID0gZmFsc2U7CiAgICAgIC8vIGlmIHRoZSBicm93c2VyIHN1cHBvcnRzIG1lZGlhRGV2aWNlcy5nZXRVc2VyTWVkaWEgQVBJCiAgICAgIGlmIChuYXZpZ2F0b3IubWVkaWFEZXZpY2VzICYmIG5hdmlnYXRvci5tZWRpYURldmljZXMuZ2V0VXNlck1lZGlhKSB7CiAgICAgICAgcmV0dXJuICgKICAgICAgICAgIG5hdmlnYXRvci5tZWRpYURldmljZXMKICAgICAgICAgICAgLmdldFVzZXJNZWRpYSh7CiAgICAgICAgICAgICAgdmlkZW86IHsgZGV2aWNlSWQ6IHRoaXMudmlkZW9EZXZpY2UgfSwKICAgICAgICAgICAgfSkKICAgICAgICAgICAgLnRoZW4oKHN0cmVhbSkgPT4gewogICAgICAgICAgICAgIHRoaXMuc3RyZWFtID0gc3RyZWFtCiAgICAgICAgICAgICAgLy8gc2V0IDx2aWRlbz4gc291cmNlIGFzIHRoZSB3ZWJjYW0gaW5wdXQKICAgICAgICAgICAgICBsZXQgdmlkZW8gPSB0aGlzLiRyZWZzLnZpZGVvCiAgICAgICAgICAgICAgdmlkZW8uc3JjT2JqZWN0ID0gdGhpcy5zdHJlYW07CiAgICAgICAgICAgICAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlKSA9PiB7CiAgICAgICAgICAgICAgICAvLyB3aGVuIHZpZGVvIGlzIGxvYWRlZAogICAgICAgICAgICAgICAgdmlkZW8ub25sb2FkZWRtZXRhZGF0YSA9ICgpID0+IHsKICAgICAgICAgICAgICAgICAgLy8gY2FsY3VsYXRlIHRoZSB2aWRlbyByYXRpbwogICAgICAgICAgICAgICAgICB0aGlzLnZpZGVvUmF0aW8gPSB2aWRlby52aWRlb0hlaWdodCAvIHZpZGVvLnZpZGVvV2lkdGg7CiAgICAgICAgICAgICAgICAgIC8vIGFkZCBldmVudCBsaXN0ZW5lciBvbiByZXNpemUgdG8gcmVzZXQgdGhlIDx2aWRlbz4gYW5kIDxjYW52YXM+IHNpemVzCiAgICAgICAgICAgICAgICAgIHRoaXMuaXNWaWRlb1N0cmVhbVJlYWR5ID0gdHJ1ZTsKICAgICAgICAgICAgICAgICAgdmlkZW8ucGxheSgpCiAgICAgICAgICAgICAgICAgIHJlc29sdmUoKTsKICAgICAgICAgICAgICAgIH07CiAgICAgICAgICAgICAgfSk7CiAgICAgICAgICAgIH0pCiAgICAgICAgICAgIC8vIGVycm9yIGhhbmRsaW5nCiAgICAgICAgICAgIC5jYXRjaCgoZXJyb3IpID0+IHsKICAgICAgICAgICAgICBjb25zb2xlLmxvZygiZmFpbGVkIHRvIGluaXRpYWxpemUgd2ViY2FtIHN0cmVhbSIsIGVycm9yKTsKICAgICAgICAgICAgfSkKICAgICAgICApOwogICAgICB9CiAgICB9LAogICAgbG9hZE1vZGVsKCkgewogICAgICByZXR1cm4gdG1JbWFnZQogICAgICAgIC5sb2FkKCIvZ2VzdHVyZS9tb2RlbC5qc29uIiwgIi9nZXN0dXJlL21ldGFkYXRhLmpzb24iKQogICAgICAgIC50aGVuKChtb2RlbCkgPT4gewogICAgICAgICAgdGhpcy5tb2RlbCA9IG1vZGVsOwogICAgICAgICAgdGhpcy5pc01vZGVsUmVhZHkgPSB0cnVlOwogICAgICAgIH0pCiAgICAgICAgLmNhdGNoKChlcnJvcikgPT4gewogICAgICAgICAgY29uc29sZS5sb2coImZhaWxlZCB0byBsb2FkIHRoZSBtb2RlIiwgZXJyb3IpOwogICAgICAgICAgdGhyb3cgZXJyb3I7CiAgICAgICAgfSk7CiAgICB9LAogICAgZGV0ZWN0T2JqZWN0cygpIHsKICAgICAgaWYgKCF0aGlzLmlzTW9kZWxSZWFkeSkgcmV0dXJuOwogICAgICBpZiAodGhpcy5pc1ZpZGVvU3RyZWFtUmVhZHkpIHsKICAgICAgICB0aGlzLm1vZGVsLnByZWRpY3QodGhpcy4kcmVmcy52aWRlbykudGhlbigocHJlZGljdGlvbnMpID0+IHsKICAgICAgICAgIHRoaXMuaGFuZGxlUHJlZGljdGlvbnMocHJlZGljdGlvbnMpOwogICAgICAgICAgdGhpcy5yYWYgPSByZXF1ZXN0QW5pbWF0aW9uRnJhbWUoKCkgPT4gewogICAgICAgICAgICB0aGlzLmRldGVjdE9iamVjdHMoKTsKICAgICAgICAgIH0pOwogICAgICAgIH0pOwogICAgICB9IGVsc2UgewogICAgICAgIHRoaXMucmFmID0gcmVxdWVzdEFuaW1hdGlvbkZyYW1lKCgpID0+IHsKICAgICAgICAgIHRoaXMuZGV0ZWN0T2JqZWN0cygpOwogICAgICAgIH0pOwogICAgICB9CiAgICB9LAogICAgaGFuZGxlUHJlZGljdGlvbnMocHJlZGljdGlvbnMpIHsKICAgICAgdGhpcy5wcmVkaWN0aW9ucy5zcGxpY2UoMCk7CiAgICAgIGxldCBtYXhQcmVkaWN0aW9uOwogICAgICBsZXQgbWF4UHJvYiA9IDA7CiAgICAgIHByZWRpY3Rpb25zLmZvckVhY2goKHByZWRpY3Rpb24pID0+IHsKICAgICAgICB0aGlzLnByZWRpY3Rpb25zLnB1c2goewogICAgICAgICAgbmFtZTogcHJlZGljdGlvbi5jbGFzc05hbWUsCiAgICAgICAgICBzY29yZTogKHByZWRpY3Rpb24ucHJvYmFiaWxpdHkgKiAxMDApLnRvRml4ZWQoMSksCiAgICAgICAgfSk7CiAgICAgICAgaWYgKHByZWRpY3Rpb24ucHJvYmFiaWxpdHkgPiBtYXhQcm9iKSB7CiAgICAgICAgICBtYXhQcm9iID0gcHJlZGljdGlvbi5wcm9iYWJpbGl0eTsKICAgICAgICAgIG1heFByZWRpY3Rpb24gPSBwcmVkaWN0aW9uOwogICAgICAgIH0KICAgICAgfSk7CiAgICAgIGlmICh0aGlzLmxhc3RQcmVkaWN0aW9uICE9IG1heFByZWRpY3Rpb24uY2xhc3NOYW1lKSB7CiAgICAgICAgdGhpcy5sYXN0UHJlZGljdGlvbiA9IG1heFByZWRpY3Rpb24uY2xhc3NOYW1lOwogICAgICAgIGlmICh0aGlzLnRpbWVvdXQpIHsKICAgICAgICAgIGNsZWFyVGltZW91dCh0aGlzLnRpbWVvdXQpCiAgICAgICAgfQogICAgICAgIHRoaXMudGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgICAgaWYgKHRoaXMubGFzdFByZWRpY3Rpb24gIT0gJ05vdGhpbmcnKSB7CiAgICAgICAgICAgIHRoaXMuJGVtaXQoJ2dlc3R1cmUnLCB0aGlzLmxhc3RQcmVkaWN0aW9uLnRvTG93ZXJDYXNlKCkpCiAgICAgICAgICB9CiAgICAgICAgfSwgMTUwMCkKICAgICAgfQogICAgfSwKICB9LAp9Owo="},{"version":3,"sources":["Gesture.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA8BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Gesture.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-card-text>\n    <v-select\n      :items=\"devices\"\n      v-model=\"videoDevice\"\n      item-text=\"label\"\n      item-value=\"deviceId\"\n    />\n    <video ref=\"video\"></video>\n    <div>\n      <table>\n        <tr v-for=\"(prediction, index) in predictions\" v-bind:key=\"index\">\n          <td>\n            <label :for=\"prediction.name\">{{ prediction.name }}</label>\n          </td>\n          <td>\n            <meter\n              :id=\"prediction.name\"\n              :value=\"prediction.score\"\n              min=\"0\"\n              max=\"100\"\n            />\n          </td>\n        </tr>\n      </table>\n    </div>\n  </v-card-text>\n</template>\n\n<script>\nimport * as tf from \"@tensorflow/tfjs\";\nimport * as tmImage from \"@teachablemachine/image\";\nexport default {\n  name: \"App\",\n  components: {},\n  data() {\n    return {\n      videoDevice: \"\",\n      devices: [],\n      baseModel: \"mobilenet_v2\",\n      isModelReady: false,\n      predictions: [\n        { name: 'Rock', score: 0 },\n        { name: 'Paper', score: 0 },\n        { name: 'Scissors', score: 0 }\n      ],\n      lastPrediction: \"\",\n    };\n  },\n  mounted() {\n    tf.setBackend(\"webgl\");\n    this.listVideoDevices()\n      .then((videoDevices) => {\n        for (let device of videoDevices) {\n          this.devices.push(device);\n        }\n        this.videoDevice = videoDevices[0].deviceId;\n      })\n      .then(() => {\n        return this.initWebcamStream();\n      })\n      .then(() => {\n        return this.loadModel().then(() => {\n          this.detectObjects();\n        });\n      });\n  },\n  beforeDestroy() {\n    if (this.raf) {\n      let video = this.$refs.video\n      video.pause()\n      video.srcObject = null\n      \n      this.stream.getTracks().forEach(track => {\n        track.stop()\n      })\n      this.isVideoStreamReady = false\n      cancelAnimationFrame(this.raf)\n    }\n  },\n  methods: {\n    listVideoDevices() {\n      return navigator.mediaDevices.enumerateDevices().then((devices) => {\n        return devices.filter((device) => device.kind === \"videoinput\");\n      });\n    },\n    initWebcamStream() {\n      this.isVideoStreamReady = false;\n      // if the browser supports mediaDevices.getUserMedia API\n      if (navigator.mediaDevices && navigator.mediaDevices.getUserMedia) {\n        return (\n          navigator.mediaDevices\n            .getUserMedia({\n              video: { deviceId: this.videoDevice },\n            })\n            .then((stream) => {\n              this.stream = stream\n              // set <video> source as the webcam input\n              let video = this.$refs.video\n              video.srcObject = this.stream;\n              return new Promise((resolve) => {\n                // when video is loaded\n                video.onloadedmetadata = () => {\n                  // calculate the video ratio\n                  this.videoRatio = video.videoHeight / video.videoWidth;\n                  // add event listener on resize to reset the <video> and <canvas> sizes\n                  this.isVideoStreamReady = true;\n                  video.play()\n                  resolve();\n                };\n              });\n            })\n            // error handling\n            .catch((error) => {\n              console.log(\"failed to initialize webcam stream\", error);\n            })\n        );\n      }\n    },\n    loadModel() {\n      return tmImage\n        .load(\"/gesture/model.json\", \"/gesture/metadata.json\")\n        .then((model) => {\n          this.model = model;\n          this.isModelReady = true;\n        })\n        .catch((error) => {\n          console.log(\"failed to load the mode\", error);\n          throw error;\n        });\n    },\n    detectObjects() {\n      if (!this.isModelReady) return;\n      if (this.isVideoStreamReady) {\n        this.model.predict(this.$refs.video).then((predictions) => {\n          this.handlePredictions(predictions);\n          this.raf = requestAnimationFrame(() => {\n            this.detectObjects();\n          });\n        });\n      } else {\n        this.raf = requestAnimationFrame(() => {\n          this.detectObjects();\n        });\n      }\n    },\n    handlePredictions(predictions) {\n      this.predictions.splice(0);\n      let maxPrediction;\n      let maxProb = 0;\n      predictions.forEach((prediction) => {\n        this.predictions.push({\n          name: prediction.className,\n          score: (prediction.probability * 100).toFixed(1),\n        });\n        if (prediction.probability > maxProb) {\n          maxProb = prediction.probability;\n          maxPrediction = prediction;\n        }\n      });\n      if (this.lastPrediction != maxPrediction.className) {\n        this.lastPrediction = maxPrediction.className;\n        if (this.timeout) {\n          clearTimeout(this.timeout)\n        }\n        this.timeout = setTimeout(() => {\n          if (this.lastPrediction != 'Nothing') {\n            this.$emit('gesture', this.lastPrediction.toLowerCase())\n          }\n        }, 1500)\n      }\n    },\n  },\n};\n</script>\n\n<style>\nvideo {\n  width: 100%;\n}\n</style>"]}]}