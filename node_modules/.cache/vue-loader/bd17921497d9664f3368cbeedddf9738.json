{"remainingRequest":"/Users/gracesmart/Desktop/rps-client-main/node_modules/vue-loader/lib/index.js??vue-loader-options!/Users/gracesmart/Desktop/rps-client-main/src/components/Speech.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/gracesmart/Desktop/rps-client-main/src/components/Speech.vue","mtime":1624639572000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/gracesmart/Desktop/rps-client-main/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:Ly8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KLy8KCmltcG9ydCAqIGFzIHRmIGZyb20gJ0B0ZW5zb3JmbG93L3RmanMnCmltcG9ydCAqIGFzIHNwZWVjaENvbW1hbmRzIGZyb20gJ0B0ZW5zb3JmbG93LW1vZGVscy9zcGVlY2gtY29tbWFuZHMnCmV4cG9ydCBkZWZhdWx0IHsKICBuYW1lOiAnQXBwJywKICBkYXRhICgpIHsKICAgIHJldHVybiB7CiAgICAgIGlzTW9kZWxSZWFkeTogZmFsc2UsCiAgICAgIHByZWRpY3Rpb25zOiBbXSwKICAgICAgYXVkaW9UcmFja0NvbnN0cmFpbnRzOiB7fSwKICAgICAgYXVkaW9EZXZpY2VzOiBbXSwKICAgICAgYXVkaW9EZXZpY2U6ICcnCiAgICB9CiAgfSwKICB3YXRjaDogewogICAgYXVkaW9EZXZpY2U6IGZ1bmN0aW9uIChkZXZpY2VJZCkgewogICAgICBpZiAodGhpcy5yZWNvZ25pemVyKSB7CiAgICAgICAgdGhpcy5zZXR1cFJlY29nbml6ZXIoZGV2aWNlSWQpCiAgICAgIH0KICAgIH0KICB9LAogIGNvbXB1dGVkOiB7CiAgICBzb3J0ZWRQcmVkaWN0aW9ucyAoKSB7CiAgICAgIGNvbnN0IHByZWRpY3Rpb25zID0gWy4uLnRoaXMucHJlZGljdGlvbnNdCiAgICAgIHByZWRpY3Rpb25zLnNvcnQoKGEsIGIpID0+IHsKICAgICAgICByZXR1cm4gKGIuc2NvcmUgLSBhLnNjb3JlKQogICAgICB9KQogICAgICByZXR1cm4gcHJlZGljdGlvbnMKICAgIH0sCiAgICB0b3BQcmVkaWN0aW9uICgpIHsKICAgICAgaWYgKHRoaXMuc29ydGVkUHJlZGljdGlvbnMubGVuZ3RoID4gMCkgewogICAgICAgIHJldHVybiB0aGlzLnNvcnRlZFByZWRpY3Rpb25zWzBdCiAgICAgIH0KICAgICAgZWxzZSB7CiAgICAgICAgcmV0dXJuIG51bGwKICAgICAgfQogICAgfSwKICAgIGZpbHRlcmVkU29ydGVkUHJlZGljdGlvbnMgKCkgewogICAgICBjb25zdCB0ID0gdGhpcy50b3BQcmVkaWN0aW9uCiAgICAgIHJldHVybiB0aGlzLnNvcnRlZFByZWRpY3Rpb25zLmZpbHRlcihwID0+IHAgIT0gdCkKICAgIH0KICB9LAogIGFzeW5jIG1vdW50ZWQgKCkgewogICAgdGYuc2V0QmFja2VuZCgnd2ViZ2wnKQogICAgY29uc3QgZW51bWVyYXRvclByb21pc2UgPSBuYXZpZ2F0b3IubWVkaWFEZXZpY2VzLmVudW1lcmF0ZURldmljZXMoKQogICAgZW51bWVyYXRvclByb21pc2UudGhlbihhc3luYyBkZXZpY2VzID0+IHsKICAgICAgZGV2aWNlcy5mb3JFYWNoKGRldmljZSA9PiB7CiAgICAgICAgaWYgKGRldmljZS5raW5kID09PSAnYXVkaW9pbnB1dCcpIHsKICAgICAgICAgIHRoaXMuYXVkaW9EZXZpY2VzLnB1c2goZGV2aWNlKQogICAgICAgIH0KICAgICAgfSkKICAgICAgdGhpcy5hdWRpb0RldmljZSA9IHRoaXMuYXVkaW9EZXZpY2VzWzBdLmRldmljZUlkCiAgICAgIHRoaXMucmVjb2duaXplciA9IGF3YWl0IHRoaXMuY3JlYXRlTW9kZWwoKQogICAgICB0aGlzLmNsYXNzTGFiZWxzID0gdGhpcy5yZWNvZ25pemVyLndvcmRMYWJlbHMoKSAvLyBnZXQgY2xhc3MgbGFiZWxzCiAgICAgIAogICAgICB0aGlzLnNldHVwUmVjb2duaXplcih0aGlzLmF1ZGlvRGV2aWNlKQogICAgfSkKICB9LAogIGJlZm9yZURlc3Ryb3koKSB7CiAgICBpZiAodGhpcy5yZWNvZ25pemVyKSB7CiAgICAgIHRoaXMucmVjb2duaXplci5zdG9wTGlzdGVuaW5nKCkKICAgIH0KICB9LAogIG1ldGhvZHM6IHsKICAgIGFzeW5jIHNldHVwUmVjb2duaXplciAoZGV2aWNlSWQpIHsKICAgICAgaWYgKHRoaXMucmVjb2duaXplci5pc0xpc3RlbmluZygpKSB7CiAgICAgICAgYXdhaXQgdGhpcy5yZWNvZ25pemVyLnN0b3BMaXN0ZW5pbmcoKQogICAgICB9CiAgICAgIC8vIGxpc3RlbigpIHRha2VzIHR3byBhcmd1bWVudHM6CiAgICAgIC8vIDEuIEEgY2FsbGJhY2sgZnVuY3Rpb24gdGhhdCBpcyBpbnZva2VkIGFueXRpbWUgYSB3b3JkIGlzIHJlY29nbml6ZWQuCiAgICAgIC8vIDIuIEEgY29uZmlndXJhdGlvbiBvYmplY3Qgd2l0aCBhZGp1c3RhYmxlIGZpZWxkcwogICAgICBhd2FpdCB0aGlzLnJlY29nbml6ZXIubGlzdGVuKHJlc3VsdCA9PiB7CiAgICAgICAgdGhpcy5oYW5kbGVQcmVkaWN0aW9ucyhyZXN1bHQuc2NvcmVzKQogICAgICB9LCB7CiAgICAgICAgICBpbmNsdWRlU3BlY3Ryb2dyYW06IGZhbHNlLCAvLyBpbiBjYXNlIGxpc3RlbiBzaG91bGQgcmV0dXJuIHJlc3VsdC5zcGVjdHJvZ3JhbQogICAgICAgICAgcHJvYmFiaWxpdHlUaHJlc2hvbGQ6IDAuNzUsCiAgICAgICAgICBpbnZva2VDYWxsYmFja09uTm9pc2VBbmRVbmtub3duOiB0cnVlLAogICAgICAgICAgb3ZlcmxhcEZhY3RvcjogMC41LCAvLyBwcm9iYWJseSB3YW50IGJldHdlZW4gMC41IGFuZCAwLjc1LiBNb3JlIGluZm8gaW4gUkVBRE1FCiAgICAgICAgICBhdWRpb1RyYWNrQ29uc3RyYWludHM6IHsKICAgICAgICAgICAgZGV2aWNlSWQ6IGRldmljZUlkCiAgICAgICAgICB9CiAgICAgIH0pCiAgICB9LAogICAgYXN5bmMgY3JlYXRlTW9kZWwoKSB7CiAgICAgICAgY29uc3QgYmFzZVVSTCA9IGAke2xvY2F0aW9uLnByb3RvY29sfS8vJHtsb2NhdGlvbi5ob3N0fWAKICAgICAgICBjb25zdCBjaGVja3BvaW50VVJMID0gYCR7YmFzZVVSTH0vc3BlZWNoL21vZGVsLmpzb25gCiAgICAgICAgY29uc3QgbWV0YWRhdGFVUkwgPSBgJHtiYXNlVVJMfS9zcGVlY2gvbWV0YWRhdGEuanNvbmAKICAgICAgICBjb25zdCByZWNvZ25pemVyID0gc3BlZWNoQ29tbWFuZHMuY3JlYXRlKAogICAgICAgICAgICAnQlJPV1NFUl9GRlQnLAogICAgICAgICAgICB1bmRlZmluZWQsCiAgICAgICAgICAgIGNoZWNrcG9pbnRVUkwsCiAgICAgICAgICAgIG1ldGFkYXRhVVJMKQogICAgICAgIC8vIGNoZWNrIHRoYXQgbW9kZWwgYW5kIG1ldGFkYXRhIGFyZSBsb2FkZWQgdmlhIEhUVFBTIHJlcXVlc3RzLgogICAgICAgIGF3YWl0IHJlY29nbml6ZXIuZW5zdXJlTW9kZWxMb2FkZWQoKQogICAgICAgIHJldHVybiByZWNvZ25pemVyCiAgICB9LAogICAgaGFuZGxlUHJlZGljdGlvbnMgKHByZWRpY3Rpb25zKSB7CiAgICAgICAgdGhpcy5wcmVkaWN0aW9ucy5sZW5ndGggPSAwCiAgICAgICAgCiAgICAgICAgcHJlZGljdGlvbnMuZm9yRWFjaCgocHJlZGljdGlvbiwgaW5kZXgpID0+IHsKICAgICAgICAgICAgdGhpcy5wcmVkaWN0aW9ucy5wdXNoKHsKICAgICAgICAgICAgICBuYW1lOiB0aGlzLmNsYXNzTGFiZWxzW2luZGV4XSwKICAgICAgICAgICAgICBzY29yZTogKHByZWRpY3Rpb24gKiAxMDApLnRvRml4ZWQoMSkKICAgICAgICAgICAgfSkKICAgICAgICB9KQogICAgICAgIGNvbnN0IHByZWQgPSB0aGlzLnRvcFByZWRpY3Rpb24KICAgICAgICBpZiAocHJlZC5uYW1lICE9PSAnQmFja2dyb3VuZCBOb2lzZScpIHsKICAgICAgICAgIHRoaXMuJGVtaXQoJ3dvcmQnLCBwcmVkLm5hbWUudG9Mb3dlckNhc2UoKSkKICAgICAgICB9CiAgICB9CiAgfQp9Cg=="},{"version":3,"sources":["Speech.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;AA2BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"Speech.vue","sourceRoot":"src/components","sourcesContent":["<template>\n  <v-card-text>\n    <v-select\n      :items=\"audioDevices\"\n      v-model=\"audioDevice\"\n      item-text=\"label\"\n      item-value=\"deviceId\"\n    />\n    <v-simple-table>\n      <tbody>\n      <tr v-if=\"topPrediction != null\">\n        <td>{{ topPrediction.name }}</td>\n        <td>{{ topPrediction.score }} %</td>\n      </tr>\n      <tr v-else>\n        <td>Not sure...</td>\n      </tr>\n      <tr v-for=\"(prediction, index) in filteredSortedPredictions\" v-bind:key=\"index\">\n        <td>{{prediction.name}}</td>\n        <td>{{prediction.score}} %</td>\n      </tr>\n      </tbody>\n    </v-simple-table>\n  </v-card-text>\n</template>\n\n<script>\nimport * as tf from '@tensorflow/tfjs'\nimport * as speechCommands from '@tensorflow-models/speech-commands'\nexport default {\n  name: 'App',\n  data () {\n    return {\n      isModelReady: false,\n      predictions: [],\n      audioTrackConstraints: {},\n      audioDevices: [],\n      audioDevice: ''\n    }\n  },\n  watch: {\n    audioDevice: function (deviceId) {\n      if (this.recognizer) {\n        this.setupRecognizer(deviceId)\n      }\n    }\n  },\n  computed: {\n    sortedPredictions () {\n      const predictions = [...this.predictions]\n      predictions.sort((a, b) => {\n        return (b.score - a.score)\n      })\n      return predictions\n    },\n    topPrediction () {\n      if (this.sortedPredictions.length > 0) {\n        return this.sortedPredictions[0]\n      }\n      else {\n        return null\n      }\n    },\n    filteredSortedPredictions () {\n      const t = this.topPrediction\n      return this.sortedPredictions.filter(p => p != t)\n    }\n  },\n  async mounted () {\n    tf.setBackend('webgl')\n    const enumeratorPromise = navigator.mediaDevices.enumerateDevices()\n    enumeratorPromise.then(async devices => {\n      devices.forEach(device => {\n        if (device.kind === 'audioinput') {\n          this.audioDevices.push(device)\n        }\n      })\n      this.audioDevice = this.audioDevices[0].deviceId\n      this.recognizer = await this.createModel()\n      this.classLabels = this.recognizer.wordLabels() // get class labels\n      \n      this.setupRecognizer(this.audioDevice)\n    })\n  },\n  beforeDestroy() {\n    if (this.recognizer) {\n      this.recognizer.stopListening()\n    }\n  },\n  methods: {\n    async setupRecognizer (deviceId) {\n      if (this.recognizer.isListening()) {\n        await this.recognizer.stopListening()\n      }\n      // listen() takes two arguments:\n      // 1. A callback function that is invoked anytime a word is recognized.\n      // 2. A configuration object with adjustable fields\n      await this.recognizer.listen(result => {\n        this.handlePredictions(result.scores)\n      }, {\n          includeSpectrogram: false, // in case listen should return result.spectrogram\n          probabilityThreshold: 0.75,\n          invokeCallbackOnNoiseAndUnknown: true,\n          overlapFactor: 0.5, // probably want between 0.5 and 0.75. More info in README\n          audioTrackConstraints: {\n            deviceId: deviceId\n          }\n      })\n    },\n    async createModel() {\n        const baseURL = `${location.protocol}//${location.host}`\n        const checkpointURL = `${baseURL}/speech/model.json`\n        const metadataURL = `${baseURL}/speech/metadata.json`\n        const recognizer = speechCommands.create(\n            'BROWSER_FFT',\n            undefined,\n            checkpointURL,\n            metadataURL)\n        // check that model and metadata are loaded via HTTPS requests.\n        await recognizer.ensureModelLoaded()\n        return recognizer\n    },\n    handlePredictions (predictions) {\n        this.predictions.length = 0\n        \n        predictions.forEach((prediction, index) => {\n            this.predictions.push({\n              name: this.classLabels[index],\n              score: (prediction * 100).toFixed(1)\n            })\n        })\n        const pred = this.topPrediction\n        if (pred.name !== 'Background Noise') {\n          this.$emit('word', pred.name.toLowerCase())\n        }\n    }\n  }\n}\n</script>\n\n<style>\n.app {\n  font-family: Avenir, Helvetica, Arial, sans-serif;\n  -webkit-font-smoothing: antialiased;\n  -moz-osx-font-smoothing: grayscale;\n  color: #2c3e50;\n  margin-top: 60px;\n}\ntable {\n  width: 100%;\n  border-spacing: 5px;\n}\n.margin-10 {\n  margin: 10px;\n}\n.top-row {\n  background-color: rgba(0, 200, 0, 0.1);\n  height: 40px;\n  font-weight: 900;\n}\n.other-rows {\n  background-color: rgba(200, 0, 0, 0.1);\n  height: 30px;\n  font-weight: 400;\n}\ntd {\n  padding: 5px;\n}\ntd:nth-child(1) {\n  width: 70%;\n    text-align: left;\n}\ntd:nth-child(2) {\n  width: 30%;\n  text-align: center;\n}\n.center-container {\n  width: 600px;\n  margin: 0 auto;\n}\n.device-select {\n  width: 100%;\n}\n</style>"]}]}